<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ§ª BÃ i thi tá»± luáº­n</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass{background:rgba(255,255,255,.92);backdrop-filter:blur(8px)}
    .soft-shadow{box-shadow:0 10px 25px rgba(0,0,0,.08)}
  </style>
</head>
<body class="min-h-screen bg-slate-50">
  <main class="max-w-3xl mx-auto px-4 py-10 space-y-8">

    <!-- Header -->
    <header class="text-center">
      <h1 class="text-3xl font-extrabold tracking-wide" style="color:#00A3C6">ğŸ§ª BÃ i thi tá»± luáº­n</h1>
      <p class="text-slate-600 mt-2">Nháº­p tÃªn cá»§a báº¡n, báº¥m <b>Báº¯t Ä‘áº§u</b> Ä‘á»ƒ lÃ m bÃ i. Khi hoÃ n thÃ nh hÃ£y <b>Ná»™p bÃ i</b>.</p>
    </header>

    <!-- Screen 1: nháº­p tÃªn -->
    <section id="screenWelcome" class="glass soft-shadow rounded-2xl p-6">
      <label class="block text-sm font-semibold mb-2">TÃªn nhÃ¢n viÃªn</label>
      <input id="employeeName" class="w-full border rounded-lg p-3" placeholder="Nháº­p tÃªn cá»§a báº¡n"/>
      <button id="btnStart" class="mt-4 bg-sky-600 text-white font-semibold px-5 py-3 rounded-lg hover:bg-sky-700">
        â–¶ï¸ Báº¯t Ä‘áº§u
      </button>
    </section>

    <!-- Screen 2: lÃ m bÃ i -->
    <section id="screenQuiz" class="hidden glass soft-shadow rounded-2xl p-6">
      <h2 class="text-xl font-bold mb-4">CÃ¢u há»i</h2>

      <!-- Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i / thÃªm bá»›t cÃ¢u á»Ÿ dÆ°á»›i -->
      <div class="space-y-5">
        <div>
          <p class="font-semibold">1) MÃ´ táº£ ngáº¯n gá»n quy trÃ¬nh xá»­ lÃ½ khi nháº­n pháº£n Ã¡nh cá»§a Ä‘áº¡i lÃ½?</p>
          <textarea class="quiz-answer w-full border rounded-lg p-3 mt-2" rows="4" placeholder="CÃ¢u tráº£ lá»i cá»§a báº¡n..."></textarea>
        </div>
        <div>
          <p class="font-semibold">2) HÃ£y nÃªu 3 tiÃªu chÃ­ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ rá»§i ro cá»§a 1 case?</p>
          <textarea class="quiz-answer w-full border rounded-lg p-3 mt-2" rows="4" placeholder="CÃ¢u tráº£ lá»i cá»§a báº¡n..."></textarea>
        </div>
        <div>
          <p class="font-semibold">3) Khi nÃ o cáº§n chuyá»ƒn case lÃªn cáº¥p quáº£n lÃ½ vÃ  báº¡n cáº§n chuáº©n bá»‹ gÃ¬?</p>
          <textarea class="quiz-answer w-full border rounded-lg p-3 mt-2" rows="4" placeholder="CÃ¢u tráº£ lá»i cá»§a báº¡n..."></textarea>
        </div>
      </div>

      <button id="btnSubmit" class="mt-6 bg-emerald-600 text-white font-semibold px-5 py-3 rounded-lg hover:bg-emerald-700">
        ğŸ“¤ Ná»™p bÃ i
      </button>
    </section>

    <!-- Screen 3: cáº£m Æ¡n -->
    <section id="screenThank" class="hidden glass soft-shadow rounded-2xl p-6 text-center">
      <h2 class="text-xl font-bold mb-2">ğŸ‰ Cáº£m Æ¡n báº¡n!</h2>
      <p class="text-slate-700 leading-relaxed">
        Cáº£m Æ¡n báº¡n Ä‘Ã£ cá»‘ gáº¯ng hoÃ n thÃ nh pháº§n thi cá»§a mÃ¬nh, báº¡n vui lÃ²ng Ä‘á»£i cÃ´ng bá»‘ káº¿t quáº£ tá»« bá»™ pháº­n liÃªn quan. Cáº£m Æ¡n.
      </p>
      <a href="index.html" class="inline-block mt-5 text-sky-600 hover:underline">âŸµ Quay vá» trang chÃ­nh</a>
    </section>

  </main>

  <script>
    // ğŸ‘‰ THAY báº±ng Web App URL cá»§a Apps Script cá»§a báº¡n
    const WEB_APP_URL = "https://script.google.com/macros/s/YOUR_WEB_APP_URL/exec";

    const $ = s => document.querySelector(s);
    const screenWelcome = $("#screenWelcome");
    const screenQuiz    = $("#screenQuiz");
    const screenThank   = $("#screenThank");
    const btnStart      = $("#btnStart");
    const btnSubmit     = $("#btnSubmit");
    const employeeName  = $("#employeeName");

    btnStart.addEventListener("click", () => {
      const name = employeeName.value.trim();
      if (!name) { alert("Vui lÃ²ng nháº­p tÃªn!"); return; }
      screenWelcome.classList.add("hidden");
      screenQuiz.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    btnSubmit.addEventListener("click", async () => {
      const name = employeeName.value.trim();
      const answers = [...document.querySelectorAll(".quiz-answer")].map((el, idx) => ({
        q: idx + 1, a: el.value.trim()
      }));

      // Kiá»ƒm tra Ã­t nháº¥t cÃ³ tráº£ lá»i
      if (answers.every(x => !x.a)) {
        alert("Báº¡n chÆ°a nháº­p cÃ¢u tráº£ lá»i nÃ o.");
        return;
      }

      btnSubmit.disabled = true; btnSubmit.textContent = "Äang ná»™p...";

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          // KhÃ´ng set Content-Type Ä‘á»ƒ trÃ¡nh CORS preflight vá»›i Apps Script
          body: JSON.stringify({
            action: "submit-quiz",
            employee: name,
            answers
          })
        });
        const json = await res.json();
        if (!json.ok) throw new Error(json.error || "Submit failed");

        screenQuiz.classList.add("hidden");
        screenThank.classList.remove("hidden");
        window.scrollTo({ top: 0, behavior: "smooth" });
      } catch (e) {
        console.error(e);
        alert("âŒ Lá»—i ná»™p bÃ i, vui lÃ²ng thá»­ láº¡i!");
      } finally {
        btnSubmit.disabled = false; btnSubmit.textContent = "ğŸ“¤ Ná»™p bÃ i";
      }
    });
  </script>
</body>
</html>
