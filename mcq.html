<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ“ BÃ i thi tráº¯c nghiá»‡m</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass{background:rgba(255,255,255,.92);backdrop-filter:blur(8px)}
    .soft-shadow{box-shadow:0 10px 25px rgba(0,0,0,.08)}
  </style>
</head>
<body class="min-h-screen bg-slate-50">
  <main class="max-w-3xl mx-auto px-4 py-10 space-y-8">

    <!-- Header -->
    <header class="text-center">
      <h1 class="text-3xl font-extrabold tracking-wide" style="color:#00A3C6">ğŸ“ BÃ i thi tráº¯c nghiá»‡m</h1>
      <p class="text-slate-600 mt-2">
        Nháº­p tÃªn cá»§a báº¡n, báº¥m <b>Báº¯t Ä‘áº§u</b> Ä‘á»ƒ lÃ m bÃ i. HoÃ n thÃ nh báº¥m <b>Ná»™p bÃ i</b>.
      </p>
    </header>

    <!-- Screen 1: nháº­p tÃªn -->
    <section id="screenWelcome" class="glass soft-shadow rounded-2xl p-6">
      <label class="block text-sm font-semibold mb-2">TÃªn nhÃ¢n viÃªn</label>
      <input id="employeeName" class="w-full border rounded-lg p-3" placeholder="Nháº­p tÃªn cá»§a báº¡n"/>
      <button id="btnStart" class="mt-4 bg-sky-600 text-white font-semibold px-5 py-3 rounded-lg hover:bg-sky-700">
        â–¶ï¸ Báº¯t Ä‘áº§u
      </button>
    </section>

    <!-- Screen 2: lÃ m bÃ i -->
    <section id="screenQuiz" class="hidden glass soft-shadow rounded-2xl p-6">
      <h2 class="text-xl font-bold mb-4">CÃ¢u há»i</h2>
      <div id="quizBox" class="space-y-6"></div>

      <button id="btnSubmit" class="mt-6 bg-emerald-600 text-white font-semibold px-5 py-3 rounded-lg hover:bg-emerald-700">
        ğŸ“¤ Ná»™p bÃ i
      </button>
    </section>

    <!-- Screen 3: cáº£m Æ¡n -->
    <section id="screenThank" class="hidden glass soft-shadow rounded-2xl p-6 text-center">
      <h2 class="text-xl font-bold mb-2">ğŸ‰ Cáº£m Æ¡n báº¡n!</h2>
      <p id="thankMsg" class="text-slate-700 leading-relaxed"></p>
      <a href="index.html" class="inline-block mt-5 text-sky-600 hover:underline">âŸµ Quay vá» trang chÃ­nh</a>
    </section>
  </main>

  <script>
    // ğŸ‘‰ Äá»”I thÃ nh Web App URL cá»§a Apps Script cá»§a báº¡n
    const WEB_APP_URL = "https://script.google.com/macros/s/REPLACE_ME/exec";

    // ====== KHAI BÃO CÃ‚U Há»I (báº¡n chá»‰nh á»Ÿ Ä‘Ã¢y) ======
    // - text: ná»™i dung cÃ¢u há»i
    // - img: (tÃ¹y chá»n) link áº£nh minh há»a
    // - options: máº£ng cÃ¡c Ä‘Ã¡p Ã¡n
    // - correct: chá»‰ sá»‘ Ä‘Ã¡p Ã¡n Ä‘Ãºng (0..n-1)
    const QUESTIONS = [
      {
        text: "Trong Baccarat, khi nÃ o Ä‘Æ°á»£c gá»i lÃ  'tháº¯ng tá»± nhiÃªn'?",
        img: "", // cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng
        options: [
          "Khi tá»•ng 2 lÃ¡ Ä‘áº§u lÃ  8 hoáº·c 9",
          "Khi 3 lÃ¡ cÃ³ tá»•ng 9",
          "Khi tá»•ng 2 lÃ¡ Ä‘áº§u lÃ  7",
          "Khi Ä‘áº·t cÆ°á»£c Banker"
        ],
        correct: 0
      },
      {
        text: "áº¢nh sau minh há»a káº¿t quáº£, ngÆ°á»i chÆ¡i tháº¯ng cá»­a nÃ o?",
        img: "https://images.unsplash.com/photo-1542228262-3d663b3063f0?q=80&w=1200&auto=format&fit=crop",
        options: [
          "Player",
          "Banker",
          "HÃ²a (Tie)",
          "KhÃ´ng xÃ¡c Ä‘á»‹nh"
        ],
        correct: 1
      },
      {
        text: "Roulette cÃ³ tá»•ng cá»™ng bao nhiÃªu sá»‘ trÃªn bÃ n kiá»ƒu chÃ¢u Ã‚u?",
        img: "",
        options: ["36", "37", "38", "39"],
        correct: 1
      }
    ];
    // ================================================

    const $  = s => document.querySelector(s);
    const $$ = s => document.querySelectorAll(s);

    const screenWelcome = $("#screenWelcome");
    const screenQuiz    = $("#screenQuiz");
    const screenThank   = $("#screenThank");
    const btnStart      = $("#btnStart");
    const btnSubmit     = $("#btnSubmit");
    const employeeName  = $("#employeeName");
    const quizBox       = $("#quizBox");
    const thankMsg      = $("#thankMsg");

    // Render cÃ¢u há»i
    function renderQuiz() {
      quizBox.innerHTML = QUESTIONS.map((q, qi) => {
        const opts = q.options.map((op, oi) => `
          <label class="flex items-start gap-3">
            <input type="radio" name="q${qi}" value="${oi}" class="mt-1">
            <span>${op}</span>
          </label>
        `).join("");

        const img = q.img
          ? `<img src="${q.img}" class="w-full rounded-lg soft-shadow my-3" alt="image for Q${qi+1}">`
          : "";

        return `
          <div class="rounded-xl border p-4">
            <p class="font-semibold mb-2">CÃ¢u ${qi+1}) ${q.text}</p>
            ${img}
            <div class="space-y-2">${opts}</div>
          </div>
        `;
      }).join("");
    }

    // Start
    btnStart.addEventListener("click", () => {
      const name = employeeName.value.trim();
      if (!name) { alert("Vui lÃ²ng nháº­p tÃªn!"); return; }
      renderQuiz();
      screenWelcome.classList.add("hidden");
      screenQuiz.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Submit
    btnSubmit.addEventListener("click", async () => {
      const name = employeeName.value.trim();

      // Thu tháº­p lá»±a chá»n cá»§a tá»«ng cÃ¢u
      const picks = QUESTIONS.map((_, qi) => {
        const checked = document.querySelector(`input[name="q${qi}"]:checked`);
        return checked ? Number(checked.value) : -1; // -1: chÆ°a chá»n
      });

      // (Tuá»³ chá»n) Ã©p buá»™c lÃ m háº¿t
      if (picks.some(v => v === -1)) {
        if (!confirm("Báº¡n cÃ²n cÃ¢u chÆ°a chá»n. Váº«n ná»™p bÃ i?")) return;
      }

      // Cháº¥m Ä‘iá»ƒm
      const total = QUESTIONS.length;
      const score = picks.reduce((s, pick, i) =>
        s + (pick === QUESTIONS[i].correct ? 1 : 0), 0);

      btnSubmit.disabled = true;
      btnSubmit.textContent = "Äang ná»™p...";

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          // KhÃ´ng set Content-Type Ä‘á»ƒ trÃ¡nh preflight Apps Script
          body: JSON.stringify({
            type: "mcq",
            name,
            picks,              // máº£ng chá»‰ sá»‘ lá»±a chá»n
            score, total        // Ä‘iá»ƒm & tá»•ng
          })
        });
        const json = await res.json();
        if (!json.ok) throw new Error(json.error || "Submit failed");

        screenQuiz.classList.add("hidden");
        screenThank.classList.remove("hidden");
        thankMsg.textContent =
          `Cáº£m Æ¡n báº¡n Ä‘Ã£ hoÃ n thÃ nh bÃ i thi. Káº¿t quáº£: ${score}/${total} (â‰ˆ ${Math.round(score*100/total)}%). ` +
          `Vui lÃ²ng Ä‘á»£i cÃ´ng bá»‘ tá»« bá»™ pháº­n liÃªn quan.`;
        window.scrollTo({ top: 0, behavior: "smooth" });
      } catch (e) {
        console.error(e);
        alert("âŒ Lá»—i ná»™p bÃ i, vui lÃ²ng thá»­ láº¡i!");
      } finally {
        btnSubmit.disabled = false;
        btnSubmit.textContent = "ğŸ“¤ Ná»™p bÃ i";
      }
    });
  </script>
</body>
</html>
